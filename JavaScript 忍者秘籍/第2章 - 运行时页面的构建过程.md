[toc]

事件循环

GUI: 图形应用界面

JavaScript引擎:
1. firefox: Spidermonkey引擎
2. chrome和Opera: V8引擎
3. IE: Chakra引擎

客户端Web应用是一种GUI应用

JavaScript 代码的类型
1. 全局代码: 会被JavaScript 引擎直接执行
2. 函数代码: 只有被调用时, 才会被JavaScript 引擎执行

浏览器执行环境的核心思想基于：同一时刻只能执行一个代码片段，即所谓的单线程执行模型。


# 1. web 应用的生命周期
## 1.1 开始和结束
开始: Web应用的生命周期从用户在浏览器地址栏输入一串URL，或单击一个链接, 从服务器接收到响应时, web 应用生命周期开始
结束: 用户关掉界面

## 1.2 组成
1. 页面构建: 创建用户界面
2. 事件处理: 进入事件循环, 等待事件的发生, 当事件发生时调用事件处理器

## 1.3 页面构建
在页面构建阶段, 会执行下面两个步骤: 两个步骤会交替执行, 但是不会同步执行, 因为他们使用同一个进程
1. 解析HTML 代码, 并构建文档对象模型(DOM)
2. 执行JavaScript 代码

# 2. 事件处理
## 2.1 定义
浏览器执行环境的核心思想基于：同一时刻只能执行一个代码片段，即所谓的单线程执行模型。

浏览器使用任务队列来跟踪已经发生但未处理的事, 所有事件均会被放置到任务队列中等待浏览器的处理; 值得注意的是, 任务队列和页面构建过程是分离的, 页面构建不会参与事件处理线程 

## 2.2 流程
事件处理的流程:
1. 浏览器检查事件队列头
2. 如果浏览器没有在队列中检测到事件，则继续检查
3. 如果浏览器在队列头中检测到了事件，则取出该事件并执行相应的事件处理器（如果存在）。在这个过程中，余下的事件在事件队列中耐心等待，直到轮到它们被处理

PS: 由于一次只能处理一个事件, 所以我们必须格外注意处理所有事件的总时间。执行需要花费大量时间执行的事件处理函数会导致Web应用无响应

# 3. 事件处理
当事件处理开始之后, 浏览器会一直轮询事件任务队列(一直循环, 直到浏览器被关闭), 检查浏览器是否有挂载的事件处理函数被触发

# 4. 课后问题
1. 相比将事件处理器赋值给某个特定元素的属性上，使用addEventListener 方法来注册事件处理器的优势是什么？
> onclick 这种方式的本质是属性赋值, 这种赋值方式只能绑定一个函数, 可能会造成事件覆盖; 使用addEventListener方法来注册事件处理器的优势是什么 则没有这种缺陷